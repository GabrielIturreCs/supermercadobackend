"use strict";(self.webpackChunksales_frontend=self.webpackChunksales_frontend||[]).push([[553],{9553:(C,d,n)=>{n.r(d),n.d(d,{CategoriasComponent:()=>p});var l=n(177),o=n(9417),t=n(4438),g=n(4430),m=n(7473);function _(e,s){1&e&&(t.j41(0,"div"),t.EFF(1,"Cargando categor\xedas..."),t.k0s())}function u(e,s){if(1&e){const r=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td")(6,"button",7),t.bIt("click",function(){const a=t.eBV(r).$implicit,c=t.XpG(2);return t.Njj(c.abrirForm(!1,a))}),t.EFF(7,"Editar"),t.k0s(),t.j41(8,"button",8),t.bIt("click",function(){const a=t.eBV(r).$implicit,c=t.XpG(2);return t.Njj(c.eliminarCategoria(a))}),t.EFF(9,"Eliminar"),t.k0s()()()}if(2&e){const r=s.$implicit;t.R7$(2),t.JRh(r.nombre),t.R7$(2),t.JRh(r.descripcion)}}function f(e,s){if(1&e&&(t.j41(0,"table",5)(1,"thead")(2,"tr")(3,"th"),t.EFF(4,"Nombre"),t.k0s(),t.j41(5,"th"),t.EFF(6,"Descripci\xf3n"),t.k0s(),t.j41(7,"th"),t.EFF(8,"Acciones"),t.k0s()()(),t.j41(9,"tbody"),t.DNE(10,u,10,2,"tr",6),t.k0s()()),2&e){const r=t.XpG();t.R7$(10),t.Y8G("ngForOf",r.categorias)}}function b(e,s){1&e&&(t.j41(0,"div",9),t.EFF(1,"No hay categor\xedas cargadas."),t.k0s())}function h(e,s){if(1&e){const r=t.RV6();t.j41(0,"div",10)(1,"div",11)(2,"form",12),t.bIt("ngSubmit",function(){t.eBV(r);const a=t.XpG();return t.Njj(a.guardarCategoria())}),t.j41(3,"div",13)(4,"label"),t.EFF(5,"Nombre"),t.k0s(),t.nrm(6,"input",14),t.k0s(),t.j41(7,"div",13)(8,"label"),t.EFF(9,"Descripci\xf3n"),t.k0s(),t.nrm(10,"textarea",15),t.k0s(),t.j41(11,"button",16),t.EFF(12),t.k0s(),t.j41(13,"button",17),t.bIt("click",function(){t.eBV(r);const a=t.XpG();return t.Njj(a.cerrarForm())}),t.EFF(14,"Cancelar"),t.k0s()()()()}if(2&e){const r=t.XpG();t.R7$(2),t.Y8G("formGroup",r.form),t.R7$(9),t.Y8G("disabled",r.form.invalid),t.R7$(),t.JRh(r.editMode?"Actualizar":"Crear")}}let p=(()=>{class e{constructor(r,i,a){this.fb=r,this.categoriasService=i,this.notification=a,this.categorias=[],this.loading=!1,this.showForm=!1,this.editMode=!1,this.categoriaEditando=null,this.form=this.fb.group({nombre:["",[o.k0.required,o.k0.maxLength(40)]],descripcion:[""]})}ngOnInit(){this.cargarCategorias()}cargarCategorias(){this.loading=!0,this.categoriasService.getAll().subscribe({next:r=>{this.categorias=r,this.loading=!1},error:()=>{this.notification.error("Error","No se pudieron cargar las categor\xedas"),this.loading=!1}})}abrirForm(r,i){this.showForm=!0,this.editMode=!r,r?(this.form.reset(),this.categoriaEditando=null):i&&(this.form.patchValue({nombre:i.nombre,descripcion:i.descripcion||""}),this.categoriaEditando=i)}cerrarForm(){this.showForm=!1,this.form.reset(),this.categoriaEditando=null}guardarCategoria(){if(this.form.invalid)return;const r=this.form.value;this.editMode&&this.categoriaEditando?this.categoriasService.update(this.categoriaEditando._id,r).subscribe({next:()=>{this.notification.success("Actualizada","Categor\xeda actualizada"),this.cargarCategorias(),this.cerrarForm()},error:()=>this.notification.error("Error","No se pudo actualizar")}):this.categoriasService.create(r).subscribe({next:()=>{this.notification.success("Creada","Categor\xeda creada"),this.cargarCategorias(),this.cerrarForm()},error:()=>this.notification.error("Error","No se pudo crear")})}eliminarCategoria(r){confirm("\xbfEliminar esta categor\xeda?")&&this.categoriasService.delete(r._id).subscribe({next:()=>{this.notification.success("Eliminada","Categor\xeda eliminada"),this.cargarCategorias()},error:()=>this.notification.error("Error","No se pudo eliminar")})}static{this.\u0275fac=function(i){return new(i||e)(t.rXU(o.ok),t.rXU(g.W),t.rXU(m.J))}}static{this.\u0275cmp=t.VBU({type:e,selectors:[["app-categorias"]],standalone:!0,features:[t.aNF],decls:8,vars:4,consts:[[1,"btn","btn-primary","mb-2",3,"click"],[4,"ngIf"],["class","table table-striped",4,"ngIf"],["class","alert alert-info",4,"ngIf"],["class","card mt-3",4,"ngIf"],[1,"table","table-striped"],[4,"ngFor","ngForOf"],[1,"btn","btn-sm","btn-info",3,"click"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"alert","alert-info"],[1,"card","mt-3"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"mb-2"],["formControlName","nombre",1,"form-control"],["formControlName","descripcion",1,"form-control"],["type","submit",1,"btn","btn-success","me-2",3,"disabled"],["type","button",1,"btn","btn-secondary",3,"click"]],template:function(i,a){1&i&&(t.j41(0,"h2"),t.EFF(1,"Categor\xedas"),t.k0s(),t.j41(2,"button",0),t.bIt("click",function(){return a.abrirForm(!0)}),t.EFF(3,"Nueva categor\xeda"),t.k0s(),t.DNE(4,_,2,0,"div",1)(5,f,11,1,"table",2)(6,b,2,0,"div",3)(7,h,15,3,"div",4)),2&i&&(t.R7$(4),t.Y8G("ngIf",a.loading),t.R7$(),t.Y8G("ngIf",!a.loading&&a.categorias.length),t.R7$(),t.Y8G("ngIf",!a.loading&&!a.categorias.length),t.R7$(),t.Y8G("ngIf",a.showForm))},dependencies:[l.MD,l.Sq,l.bT,o.X1,o.qT,o.me,o.BC,o.cb,o.j4,o.JD],styles:[".categorias-container[_ngcontent-%COMP%]{max-width:700px;margin:2rem auto;background:#fff;border-radius:16px;box-shadow:0 2px 16px #00000014;padding:2rem}.btn-nuevo[_ngcontent-%COMP%]{background:#43a047;color:#fff;border:none;border-radius:8px;padding:.75rem 1.5rem;font-size:1rem;cursor:pointer;margin-bottom:1rem;transition:background .2s}.btn-nuevo[_ngcontent-%COMP%]:hover{background:#357a38}.categorias-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:1rem}.categorias-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .categorias-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem;border-bottom:1px solid #eee;text-align:left}.placeholder[_ngcontent-%COMP%]{color:#888;text-align:center}"]})}}return e})()}}]);